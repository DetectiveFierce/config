#    888    888                           888                        888
#    888    888                           888                        888
#    888    888                           888                        888
#    8888888888 888  888 88888b.  888d888 888  8888b.  88888b.   .d88888
#    888    888 888  888 888 "88b 888P"   888     "88b 888 "88b d88" 888
#    888    888 888  888 888  888 888     888 .d888888 888  888 888  888
#    888    888 Y88b 888 888 d88P 888     888 888  888 888  888 Y88b 888
#    888    888  "Y88888 88888P"  888     888 "Y888888 888  888  "Y88888
#                    888 888
#               Y8b d88P 888
#                "Y88P"  888

#################
#MONITORS ###
################  See https://wiki.hyprland.org/Configuring/Monitors/

# monitor=HDMI-A-1,2560x1080@75,0x0,1

monitor=HDMI-A-2,1920x1080,0x0,1
monitor=HDMI-A-1,1920x1080,1920x0,1
monitor=DP-1,2560x1600@60,1120x1080,2

workspace=9,monitor:DP-1
workspace=2,monitor:HDMI-A-1
workspace=1,monitor:HDMI-A-2

exec-once = hyprctl dispatch focusmonitor DP-1 && hyprctl dispatch workspace 9
exec-once = hyprctl dispatch focusmonitor HDMI-A-1 && hyprctl dispatch workspace 2
exec-once = hyprctl dispatch focusmonitor HDMI-A-2 && hyprctl dispatch workspace 1


###################
#DEFAULT PROGRAMS ###
###################  See https://wiki.hyprland.org/Configuring/Keywords/
$terminal = kitty
$fileManager = thunar
$menu = ~/.config/hypr/bang_launcher.sh

#################
#AUTOSTART ###
#################
exec-once = waybar
exec-once=walker --gapplication-service
exec-once = ~/.config/hypr/wallpaper-rotator.sh
exec-once = wl-paste --type text --watch cliphist store
exec-once = wl-paste --type image --watch cliphist store

#############################
#ENVIRONMENT VARIABLES ###
#############################  See https://wiki.hyprland.org/Configuring/Environment-variables/
env = GTK_THEME,Dark-Green-Jungle
env = XDG_CURRENT_DESKTOP,Hyprland
env = XDG_SESSION_TYPE,wayland
env = XDG_SESSION_DESKTOP,Hyprland

#################
#PLUGINS ###
#################
# Mission Control-style overview via hycov (maintained fork build for Hyprland 0.53+)
plugin = $HOME/.local/lib/hycov.so

plugin {
    hycov {
        overview_gappo = 48
        overview_gappi = 20
        enable_click_action = 1
        auto_exit = 1
        only_active_workspace = 0
        only_active_monitor = 0
        show_special = 0
        enable_hotarea = 0
        enable_gesture = 0
        raise_float_to_top = 1
    }
}

#####################
#LOOK AND FEEL ###
#####################   Refer to https://wiki.hyprland.org/Configuring/Variables/
general {
    layout = dwindle
    gaps_in = 0
    gaps_out = 0
    border_size = 0
    col.active_border = rgba(18210f00)
    col.inactive_border = rgba(18210f00)

    # Set to true enable resizing windows by clicking and dragging on borders and gaps
    resize_on_border = false
}

decoration {
    rounding = 0

    active_opacity = 1.0
    inactive_opacity = 0.80
    dim_inactive = true
    dim_strength = 0.0
    blur {
        enabled = true
        size = 6
        passes = 5
    }
}

animations {
    enabled = true
    bezier = myBezier, 0.05, 0.9, 0.1, 1.05
    animation = windows, 1, 7, myBezier
    animation = windowsOut, 1, 7, default, popin 80%
    animation = border, 1, 10, default
    animation = borderangle, 1, 8, default
    animation = fade, 1, 7, default
    animation = workspaces, 1, 6, default
} # https://wiki.hyprland.org/Configuring/Variables/#animations

dwindle {
    pseudotile = true # Master switch for pseudotiling. Enabling is bound to mainMod + P in the keybinds section below
    preserve_split = true # You probably want this
} # See https://wiki.hyprland.org/Configuring/Dwindle-Layout/ for more

master {
    new_status = master
} # See https://wiki.hyprland.org/Configuring/Master-Layout/ for more

misc {
    force_default_wallpaper = 1 # Set to 0 or 1 to disable the anime mascot wallpapers
    disable_hyprland_logo = true # If true disables the random hyprland logo / anime girl background. :(
} # https://wiki.hyprland.org/Configuring/Variables/#misc

#############
#INPUT ###
#############  See https://wiki.hyprland.org/Configuring/Variables/#input
input {
    kb_layout = us
    kb_options = caps:hyper  # Caps Lock becomes Hyper (Mod3)
    
    follow_mouse = 1
    sensitivity = 0.8
    touchpad {
        natural_scroll = true
    }
}

device{
    name = bt5.2-mouse
    sensitivity = 1
}


#######################
### MODIFIER KEYS ###
#######################
$nav = Mod3        # Caps Lock (Hyper) - Navigation
$cmd = SUPER       # Windows key - Commands/Apps


##################################
### NAVIGATION (Caps Lock) ###
##################################

# Focus movement (vim-style)
bind = $nav, H, movefocus, l
bind = $nav, J, movefocus, d
bind = $nav, K, movefocus, u
bind = $nav, L, movefocus, r

# Focus movement (arrow keys)
bind = $nav, left, movefocus, l
bind = $nav, down, movefocus, d
bind = $nav, up, movefocus, u
bind = $nav, right, movefocus, r

# Switch workspaces
bind = $nav, 1, workspace, 1
bind = $nav, 2, workspace, 2
bind = $nav, 3, workspace, 3
bind = $nav, 4, workspace, 4
bind = $nav, 5, workspace, 5
bind = $nav, 6, workspace, 6
bind = $nav, 7, workspace, 7
bind = $nav, 8, workspace, 8
bind = $nav, 9, workspace, 9
bind = $nav, 0, workspace, 10

# Move window to workspace (Nav + Shift)
bind = $nav SHIFT, 1, movetoworkspace, 1
bind = $nav SHIFT, 2, movetoworkspace, 2
bind = $nav SHIFT, 3, movetoworkspace, 3
bind = $nav SHIFT, 4, movetoworkspace, 4
bind = $nav SHIFT, 5, movetoworkspace, 5
bind = $nav SHIFT, 6, movetoworkspace, 6
bind = $nav SHIFT, 7, movetoworkspace, 7
bind = $nav SHIFT, 8, movetoworkspace, 8
bind = $nav SHIFT, 9, movetoworkspace, 9
bind = $nav SHIFT, 0, movetoworkspace, 10

# Silent move (window stays, you don't follow)
bind = $nav CTRL, 1, movetoworkspacesilent, 1
bind = $nav CTRL, 2, movetoworkspacesilent, 2
bind = $nav CTRL, 3, movetoworkspacesilent, 3
bind = $nav CTRL, 4, movetoworkspacesilent, 4
bind = $nav CTRL, 5, movetoworkspacesilent, 5
bind = $nav CTRL, 6, movetoworkspacesilent, 6
bind = $nav CTRL, 7, movetoworkspacesilent, 7
bind = $nav CTRL, 8, movetoworkspacesilent, 8
bind = $nav CTRL, 9, movetoworkspacesilent, 9
bind = $nav CTRL, 0, movetoworkspacesilent, 10

# Workspace cycling
bind = $nav, bracketleft, workspace, e-1      # Nav + [ = prev workspace
bind = $nav, bracketright, workspace, e+1     # Nav + ] = next workspace
bind = $nav, Tab, exec, ~/.config/hypr/window-switcher.sh
bind = $nav, grave, workspace, previous       # Nav + ` = last workspace (alt)

# Move window in direction (swap)
bind = $nav SHIFT, H, movewindow, l
bind = $nav SHIFT, J, movewindow, d
bind = $nav SHIFT, K, movewindow, u
bind = $nav SHIFT, L, movewindow, r

# Resize mode (Nav + R enters submap)
bind = $nav, R, submap, resize
submap = resize
binde = , H, resizeactive, -50 0
binde = , L, resizeactive, 50 0
binde = , K, resizeactive, 0 -50
binde = , J, resizeactive, 0 50
binde = , left, resizeactive, -50 0
binde = , right, resizeactive, 50 0
binde = , up, resizeactive, 0 -50
binde = , down, resizeactive, 0 50
bind = , escape, submap, reset
bind = , Return, submap, reset
bind = $nav, R, submap, reset
submap = reset

# Monitor focus
bind = $nav, comma, focusmonitor, -1          # Nav + , = prev monitor
bind = $nav, period, focusmonitor, +1         # Nav + . = next monitor
bind = $nav SHIFT, comma, movewindow, mon:-1  # Nav + Shift + , = move to prev monitor
bind = $nav SHIFT, period, movewindow, mon:+1 # Nav + Shift + . = move to next monitor

# Layout controls
bind = $nav, F, fullscreen, 0                 # True fullscreen
bind = $nav, M, fullscreen, 1                 # Maximize (keep bar)
bind = $nav, Space, hycov:toggleoverview, forceallinone  # Mission Control: gather all windows into current workspace
bind = $nav SHIFT, Space, togglesplit               # Keep split toggle available
bind = $nav, P, pseudo                        # Toggle pseudotile

# Scroll workspaces with mouse (monitor-local, includes empty workspaces)
bind = $nav, mouse_down, workspace, r+1
bind = $nav, mouse_up, workspace, r-1


##################################
### COMMANDS (Super/Windows) ###
##################################

# Core actions
bind = $cmd, Q, killactive
bind = $cmd, F6, exit

# App launchers
bind = $cmd, Return, exec, $terminal          # Primary terminal
bind = $cmd, T, togglespecialworkspace, terminal
bind = $cmd, Tab, togglespecialworkspace, terminal
bind = $cmd SHIFT, T, exec, ghostty
bind = $cmd, N, exec, alacritty -e sh -c "nvim"

bind = $cmd, D, exec, fuzzel                  # App launcher
bind = $cmd, Space, exec, ~/Desktop/flare_0.1.0_amd64.AppImage
bind = $cmd, E, exec, $fileManager
bind = $cmd, W, exec, zen-browser
bind = $cmd, O, exec, obsidian

# Editors
bind = $cmd, Z, exec, zeditor
bind = $cmd, C, exec, zeditor ~/.config/
bind = $cmd SHIFT, Z, exec, zeditor ~/.zshrc

# Clipboard
bind = $cmd, V, exec, bash -lc 'cliphist list | fuzzel --dmenu | cliphist decode | wl-copy'

# Screenshots & Color picker
bind = $cmd, P, exec, grim -g "$(slurp -d)" - | wl-copy
bind = $cmd SHIFT, P, exec, hyprpicker -a

# Window state
bind = $cmd, B, togglefloating
bind = $cmd, L, exec, hyprlock

# Special workspaces
bind = $cmd, S, togglespecialworkspace, htop
bind = $cmd SHIFT, S, movetoworkspace, special:htop
bind = $cmd, slash, togglespecialworkspace, cheatsheet

# File search
bind = $cmd SHIFT, E, exec, foot --app-id=float-term -e zsh -c "nohup rga-fzf --query=\!.pdf\$\ "
bind = $cmd SHIFT, D, exec, foot --app-id=float-term -e $SHELL -c 'source ~/.zshrc && pdf=$(find -type f | fzf --query=.pdf\$\ ); [ -n "$pdf" ] && zathura --fork "$pdf" >/dev/null 2>&1'

# Recent projects
bind = $cmd, R, exec, foot --app-id=float-term --config=$HOME/.config/foot/float-term.ini -e zsh -lc '~/.config/hypr/recent-projects-fzf editor'
bind = $cmd SHIFT, R, exec, foot --app-id=float-term --config=$HOME/.config/foot/float-term.ini -e $SHELL -lc 'source ~/.zshrc && ~/.config/hypr/recent-projects-fzf fm'

# CWD-aware launchers
bind = $cmd CTRL, C, exec, ~/.config/hypr/hypr-cwd-launch cursor
bind = $cmd CTRL, F, exec, ~/.config/hypr/hypr-cwd-launch thunar
bind = $cmd CTRL, R, exec, ~/.config/hypr/hypr-cwd-launch rstudio
bind = $cmd CTRL, T, exec, ~/.config/hypr/hypr-cwd-launch terminal

# Mouse bindings
bindm = $cmd, mouse:272, movewindow
bindm = $cmd, mouse:273, resizewindow


##################################
### FUNCTION KEYS (No Mod) ###
##################################
bind = , XF86MonBrightnessDown, exec, ddcutil setvcp 10 - 15 --display 1
bind = , XF86MonBrightnessUp, exec, ddcutil setvcp 10 + 15 --display 1
bind = , XF86AudioMute, exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
bind = , XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
bind = , XF86AudioRaiseVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%+
bind = , XF86AudioPause, exec, playerctl play-pause
bind = , XF86Back, exec, playerctl previous
bind = , XF86Forward, exec, playerctl next
bind = , F4, togglespecialworkspace, htop


##############################
#WINDOWS AND WORKSPACES ###
##############################
# Preserved system rules

workspace = special:terminal,  on-created-empty: kitty
windowrule = float on, match:class ^(kitty)$
windowrule = maximize on, match:class ^(kitty)$

workspace = special:htop, on-created-empty:kitty htop

workspace = special:cheatsheet, on-created-empty:eog ~/vim_cheatsheet.png

windowrule = tile on, match:class ^(kitty)$, match:title ^(nvim)$

windowrule = suppress_event maximize, match:class .* # You'll probably like this.
windowrule = rounding 0, match:title ^(foot)$
windowrule = float on, match:title ^(Picture in picture)$
windowrule = pin on, match:title ^(Picture in picture)$

# Ensure floating rules for foot with this app ID
windowrule = float on, match:class ^(float-term)$
windowrule = center on, match:class ^(float-term)$
windowrule = size 80% 60%, match:class ^(float-term)$
windowrule = pin on, match:class ^(float-term)$
windowrule = rounding 12, match:class ^(albert)$
windowrule = rounding 16, match:class ^(float-term)$
